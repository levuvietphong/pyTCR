
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>1. Tropical cyclone tracks and intensity &#8212; pyTCR Documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/tabs.css?v=4c969af8" />
    <link rel="stylesheet" type="text/css" href="../_static/proof.css" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-examples.css?v=e236af4b" />
    <link rel="stylesheet" type="text/css" href="../_static/css/tooltipster.custom.css" />
    <link rel="stylesheet" type="text/css" href="../_static/css/tooltipster.bundle.min.css" />
    <link rel="stylesheet" type="text/css" href="../_static/css/tooltipster-sideTip-shadow.min.css" />
    <link rel="stylesheet" type="text/css" href="../_static/css/tooltipster-sideTip-punk.min.css" />
    <link rel="stylesheet" type="text/css" href="../_static/css/tooltipster-sideTip-noir.min.css" />
    <link rel="stylesheet" type="text/css" href="../_static/css/tooltipster-sideTip-light.min.css" />
    <link rel="stylesheet" type="text/css" href="../_static/css/tooltipster-sideTip-borderless.min.css" />
    <link rel="stylesheet" type="text/css" href="../_static/css/micromodal.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=010c3e5c" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/jquery.js?v=5d32c60e"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script src="../_static/tabs.js?v=3ee01567"></script>
    <script src="../_static/js/hoverxref.js"></script>
    <script src="../_static/js/tooltipster.bundle.min.js"></script>
    <script src="../_static/js/micromodal.min.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"tex": {"macros": {"N": "\\mathbb{N}", "floor": ["\\lfloor#1\\rfloor", 1], "bmat": ["\\left[\\begin{array}"], "emat": ["\\end{array}\\right]"]}}, "options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'examples/ex1_tropical_cyclone_tracks';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="2. Tropical cyclone rainfall generation" href="ex2_rainfall_generation.html" />
    <link rel="prev" title="0. Download tropical cyclone tracks" href="ex0_download_tracks_from_cmip6.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.png" class="logo__image only-light" alt="pyTCR Documentation - Home"/>
    <script>document.write(`<img src="../_static/logo.png" class="logo__image only-dark" alt="pyTCR Documentation - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Documentation ðŸ”Ž
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Getting started ðŸš€</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../math.html">Background</a></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="examples.html">Examples</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="ex0_download_tracks_from_cmip6.html"><strong>0. Download tropical cyclone tracks</strong></a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#"><strong>1. Tropical cyclone tracks and intensity</strong></a></li>
<li class="toctree-l2"><a class="reference internal" href="ex2_rainfall_generation.html"><strong>2. Tropical cyclone rainfall generation</strong></a></li>
<li class="toctree-l2"><a class="reference internal" href="ex3_wind_speed_generation.html"><strong>3. Tropical cyclone maximum wind speed</strong></a></li>
<li class="toctree-l2"><a class="reference internal" href="ex4_rainfall_polygons_generation.html"><strong>4. Generate tropical cyclone rainfall over a specific region</strong></a></li>
<li class="toctree-l2"><a class="reference internal" href="ex5_multiple_rainfall_event_polygon.html"><strong>5. Multiple tropical cyclone rainfall events generated over a specific region</strong></a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Reference ðŸ“–</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../api/index.html">API</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/modules.html">pyTCR</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/pyTCR.html">Functions</a></li>
</ul>
</details></li>
</ul>
</details></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/examples/ex1_tropical_cyclone_tracks.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>1. Tropical cyclone tracks and intensity</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#description"><strong>Description</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#import-libraries"><strong>Import libraries</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-configurations"><strong>Plot configurations</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#tropical-cyclone-observations"><strong>Tropical cyclone observations</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#tropical-cyclone-downscaled-from-reanalysis-era5"><strong>Tropical cyclone downscaled from Reanalysis-ERA5</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#tropical-cyclone-data-downscaled-from-cmip6-models"><strong>Tropical cyclone data downscaled from CMIP6 models</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#set-up-plot-and-identify-tracks-landfalling-texas"><strong>Set up plot and identify tracks landfalling Texas</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plotting-tropical-cyclone-tracks"><strong>Plotting tropical cyclone tracks</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-tropical-cyclone-power-dissipitation-index"><strong>Plot tropical cyclone Power Dissipitation Index</strong></a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="tropical-cyclone-tracks-and-intensity">
<h1><strong>1. Tropical cyclone tracks and intensity</strong><a class="headerlink" href="#tropical-cyclone-tracks-and-intensity" title="Link to this heading">#</a></h1>
<section id="description">
<h2><strong>Description</strong><a class="headerlink" href="#description" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>This <code class="docutils literal notranslate"><span class="pre">jupyter</span> <span class="pre">notebook</span></code> loads and visualizes tropical cyclone tracks using an open-source, statistical-dynamical <a class="reference external" href="https://github.com/linjonathan/tropical_cyclone_risk">tropical cyclone downscaling model</a>.</p></li>
<li><p>The model incorporates intensity-dependent steering and is driven by large-scale environmental data from ERA5-reanalysis or CMIP6 models.</p></li>
<li><p>We demonstrate the visualization of tropical cyclone (TC) tracks and Power Dissipation Index (PDI).</p></li>
</ul>
</section>
<section id="import-libraries">
<h2><strong>Import libraries</strong><a class="headerlink" href="#import-libraries" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">load_ext</span> autoreload
<span class="o">%</span><span class="k">autoreload</span> 2

<span class="kn">import</span><span class="w"> </span><span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">cartopy.io.shapereader</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">shpreader</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">cartopy.crs</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">ccrs</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">colorcet</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">cc</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">shapefile</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">shapely.geometry</span><span class="w"> </span><span class="kn">import</span> <span class="n">shape</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">geopandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">gpd</span>

<span class="c1"># pytcr modules</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">tcr.datadir</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">tcr_data</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">tcr.iodata</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">tcr_io</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">tcr.plots</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">tcr_plot</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">tcr.physics</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">tcr_physics</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="plot-configurations">
<h2><strong>Plot configurations</strong><a class="headerlink" href="#plot-configurations" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define map projection focusing on the North Atlantic region</span>
<span class="n">projection</span> <span class="o">=</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">AzimuthalEquidistant</span><span class="p">(</span><span class="n">central_longitude</span><span class="o">=-</span><span class="mi">50</span><span class="p">,</span> <span class="n">central_latitude</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>

<span class="c1"># Define map boundaries (in degrees)</span>
<span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span> <span class="o">=</span> <span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="mi">0</span>
<span class="n">ymin</span><span class="p">,</span> <span class="n">ymax</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">60</span>
<span class="n">extent</span> <span class="o">=</span> <span class="p">[</span><span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">,</span> <span class="n">ymin</span><span class="p">,</span> <span class="n">ymax</span><span class="p">]</span>
<span class="n">basin</span> <span class="o">=</span> <span class="s1">&#39;NA&#39;</span>  <span class="c1"># North Atlantic</span>

<span class="c1"># Define the size of the latitude-longitude box for counting the number of tracks</span>
<span class="n">cellsize</span> <span class="o">=</span> <span class="mi">2</span>

<span class="c1"># Load shapefiles for plotting maps</span>
<span class="n">shapefile_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">tcr_data</span><span class="o">.</span><span class="n">DATA_DIR</span><span class="p">,</span> <span class="s1">&#39;shapefiles&#39;</span><span class="p">,</span> <span class="s1">&#39;CONUS.shp&#39;</span><span class="p">)</span>  <span class="c1"># Continental United States</span>
<span class="n">shpCONUS</span> <span class="o">=</span> <span class="n">shpreader</span><span class="o">.</span><span class="n">Reader</span><span class="p">(</span><span class="n">shapefile_path</span><span class="p">)</span>

<span class="c1"># Define the time period for the plot: 1964-2014 corresponds to the historical period in CMIP6</span>
<span class="n">start_year</span> <span class="o">=</span> <span class="mi">1964</span>
<span class="n">end_year</span> <span class="o">=</span> <span class="mi">2014</span>
<span class="n">num_years</span> <span class="o">=</span> <span class="n">end_year</span> <span class="o">-</span> <span class="n">start_year</span> <span class="o">+</span> <span class="mi">1</span>

<span class="c1"># Define the directory containing the downscaled data</span>
<span class="n">data_directory</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">tcr_data</span><span class="o">.</span><span class="n">DATA_DIR</span><span class="p">,</span> <span class="s1">&#39;downscaled&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="tropical-cyclone-observations">
<h2><strong>Tropical cyclone observations</strong><a class="headerlink" href="#tropical-cyclone-observations" title="Link to this heading">#</a></h2>
<p>Data collected in the <a class="reference external" href="https://www.ncei.noaa.gov/products/international-best-track-archive">International Best Track Archive for Climate Stewardship (IBTrACS) project</a> as tropical cyclone observations. This project merges recent and historical tropical cyclone data from multiple agencies to create a unified, publicly available, best-track dataset that improves inter-agency comparisons.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Specify the path to the observed data file</span>
<span class="n">observed_filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">tcr_data</span><span class="o">.</span><span class="n">DATA_DIR</span><span class="p">,</span> <span class="s1">&#39;observations/IBTrACS.NA.v04r00.nc&#39;</span><span class="p">)</span>

<span class="c1"># Load the observed best tracks</span>
<span class="n">lat_obs</span><span class="p">,</span> <span class="n">lon_obs</span><span class="p">,</span> <span class="n">time_obs</span><span class="p">,</span> <span class="n">id_obs</span><span class="p">,</span> <span class="n">storm_names_obs</span><span class="p">,</span> <span class="n">basin_names_obs</span><span class="p">,</span> <span class="n">vmax_obs</span><span class="p">,</span> <span class="n">storm_speed_obs</span> <span class="o">=</span> \
    <span class="n">tcr_io</span><span class="o">.</span><span class="n">load_best_tracks_obs</span><span class="p">(</span><span class="n">observed_filename</span><span class="p">,</span> <span class="n">start_year</span><span class="p">,</span> <span class="n">end_year</span><span class="p">)</span>

<span class="c1"># Estimate Power Dissipation Index (PDI) from observations</span>
<span class="n">num_obs</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">id_obs</span><span class="p">)</span>
<span class="n">lat_obs_cs</span><span class="p">,</span> <span class="n">lon_obs_cs</span><span class="p">,</span> <span class="n">pdi_obs</span> <span class="o">=</span> <span class="n">tcr_physics</span><span class="o">.</span><span class="n">estimate_pdi</span><span class="p">(</span>
    <span class="n">lat_obs</span><span class="p">,</span> <span class="n">lon_obs</span><span class="p">,</span> <span class="n">vmax_obs</span><span class="p">,</span> <span class="n">num_obs</span><span class="p">,</span> <span class="n">cellsize</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="mi">3</span>
<span class="p">)</span>  <span class="c1"># 2 degree, 3-hour interval</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="tropical-cyclone-downscaled-from-reanalysis-era5">
<h2><strong>Tropical cyclone downscaled from Reanalysis-ERA5</strong><a class="headerlink" href="#tropical-cyclone-downscaled-from-reanalysis-era5" title="Link to this heading">#</a></h2>
<p>This dataset is the outputs of the tropical cyclone downscaling model forced by large-scale environment obtained from the <a class="reference external" href="https://www.ecmwf.int/en/forecasdataset/ecmwf-reanalysis-v5">Reanalysis-ERA5</a> dataset during historical period.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Load the tracks from REANALYSIS</span>
<span class="n">lat_rea</span><span class="p">,</span> <span class="n">lon_rea</span><span class="p">,</span> <span class="n">year_rea</span><span class="p">,</span> <span class="n">id_rea</span><span class="p">,</span> <span class="n">vmax_rea</span> <span class="o">=</span> <span class="n">tcr_io</span><span class="o">.</span><span class="n">load_tracks_GCMs</span><span class="p">(</span>
    <span class="n">data_directory</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="s1">&#39;REANALYSIS&#39;</span><span class="p">,</span> <span class="n">basin</span><span class="o">=</span><span class="n">basin</span><span class="p">,</span> <span class="n">expmnt</span><span class="o">=</span><span class="s1">&#39;historical&#39;</span>
<span class="p">)</span>

<span class="c1"># Estimate Power Dissipitation Index (PDI) from reanalysis</span>
<span class="c1"># Since observations have less tracks than the reanalysis, we use the same num_obs for estimating PDI</span>
<span class="n">lat_rea_cs</span><span class="p">,</span> <span class="n">lon_rea_cs</span><span class="p">,</span> <span class="n">pdi_rea</span> <span class="o">=</span> <span class="n">tcr_physics</span><span class="o">.</span><span class="n">estimate_pdi</span><span class="p">(</span>
    <span class="n">lat_rea</span><span class="p">,</span> <span class="n">lon_rea</span><span class="p">,</span> <span class="n">vmax_rea</span><span class="p">,</span> <span class="n">num_obs</span><span class="p">,</span> <span class="n">cellsize</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="mi">1</span>
<span class="p">)</span>  <span class="c1"># 1-hour interval</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="tropical-cyclone-data-downscaled-from-cmip6-models">
<h2><strong>Tropical cyclone data downscaled from CMIP6 models</strong><a class="headerlink" href="#tropical-cyclone-data-downscaled-from-cmip6-models" title="Link to this heading">#</a></h2>
<p>This dataset is the outputs of the tropical cyclone downscaling model forced by large-scale environment obtained from the different <a class="reference external" href="https://pcmdi.llnl.gov/CMIP6/">CMIP6 models</a>. Here, the <a class="reference external" href="https://e3sm.org/">E3SM version 1.0</a> is demonstrated but the notebook is applicable to other CMIP6 models.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Load the modeled tracks from CMIP6 models (E3SM-1-0)</span>
<span class="n">lat_mod</span><span class="p">,</span> <span class="n">lon_mod</span><span class="p">,</span> <span class="n">year_mod</span><span class="p">,</span> <span class="n">id_mod</span><span class="p">,</span> <span class="n">vmax_mod</span> <span class="o">=</span> <span class="n">tcr_io</span><span class="o">.</span><span class="n">load_tracks_GCMs</span><span class="p">(</span>
    <span class="n">data_directory</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="s1">&#39;E3SM-1-0&#39;</span><span class="p">,</span> <span class="n">basin</span><span class="o">=</span><span class="n">basin</span><span class="p">,</span> <span class="n">expmnt</span><span class="o">=</span><span class="s1">&#39;historical&#39;</span>
<span class="p">)</span>

<span class="c1"># Estimate Power Dissipitation Index (PDI) from model</span>
<span class="c1"># Since observations have less tracks than the model, we use the same num_obs for estimating PDI</span>
<span class="n">lat_mod_cs</span><span class="p">,</span> <span class="n">lon_mod_cs</span><span class="p">,</span> <span class="n">pdi_mod</span> <span class="o">=</span> <span class="n">tcr_physics</span><span class="o">.</span><span class="n">estimate_pdi</span><span class="p">(</span>
    <span class="n">lat_mod</span><span class="p">,</span> <span class="n">lon_mod</span><span class="p">,</span> <span class="n">vmax_mod</span><span class="p">,</span> <span class="n">num_obs</span><span class="p">,</span> <span class="n">cellsize</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="mi">1</span>
<span class="p">)</span>  <span class="c1"># 1-hour interval</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="set-up-plot-and-identify-tracks-landfalling-texas">
<h2><strong>Set up plot and identify tracks landfalling Texas</strong><a class="headerlink" href="#set-up-plot-and-identify-tracks-landfalling-texas" title="Link to this heading">#</a></h2>
<p>Due to the large number of tropical cyclones over the historical period, we randomly select 250 tracks to enhance visualization clarity.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Read shapefile using pyshp</span>
<span class="n">sf</span> <span class="o">=</span> <span class="n">shapefile</span><span class="o">.</span><span class="n">Reader</span><span class="p">(</span><span class="n">shapefile_path</span><span class="p">)</span>

<span class="c1"># Extract Texas geometries from shapefile</span>
<span class="n">poly_TX</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">shape</span><span class="p">(</span><span class="n">shape_record</span><span class="o">.</span><span class="n">shape</span><span class="o">.</span><span class="n">__geo_interface__</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">shape_record</span> <span class="ow">in</span> <span class="n">sf</span><span class="o">.</span><span class="n">shapeRecords</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">shape_record</span><span class="o">.</span><span class="n">record</span><span class="p">[</span><span class="s1">&#39;NAME&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Texas&#39;</span>
<span class="p">]</span>

<span class="c1"># Plot parameters</span>
<span class="n">num_tracks_plot</span> <span class="o">=</span> <span class="mi">250</span>  <span class="c1"># Number of tracks to plot</span>
<span class="n">norm</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">Normalize</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">80</span><span class="p">)</span>

<span class="c1"># Get the track ids for TCs that landfall on TX</span>
<span class="n">ind_TX_mod</span> <span class="o">=</span> <span class="n">tcr_plot</span><span class="o">.</span><span class="n">get_tracks_landfall_region</span><span class="p">(</span><span class="n">lat_mod</span><span class="p">,</span> <span class="n">lon_mod</span><span class="p">,</span> <span class="n">poly_TX</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">buffer</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">num_tracks</span><span class="o">=</span><span class="n">num_obs</span><span class="p">)</span>
<span class="n">ind_TX_rea</span> <span class="o">=</span> <span class="n">tcr_plot</span><span class="o">.</span><span class="n">get_tracks_landfall_region</span><span class="p">(</span><span class="n">lat_rea</span><span class="p">,</span> <span class="n">lon_rea</span><span class="p">,</span> <span class="n">poly_TX</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">buffer</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">num_tracks</span><span class="o">=</span><span class="n">num_obs</span><span class="p">)</span>
<span class="n">ind_TX_obs</span> <span class="o">=</span> <span class="n">tcr_plot</span><span class="o">.</span><span class="n">get_tracks_landfall_region</span><span class="p">(</span><span class="n">lat_obs</span><span class="p">,</span> <span class="n">lon_obs</span><span class="p">,</span> <span class="n">poly_TX</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">buffer</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">num_tracks</span><span class="o">=</span><span class="n">num_obs</span><span class="p">)</span>

<span class="c1"># Randomly select a subset of tracks (without replacement) for visualization</span>
<span class="n">ind_mod</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">id_mod</span><span class="p">,</span> <span class="n">num_tracks_plot</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ind_rea</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">id_rea</span><span class="p">,</span> <span class="n">num_tracks_plot</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ind_obs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">id_obs</span><span class="p">,</span> <span class="n">num_tracks_plot</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="plotting-tropical-cyclone-tracks">
<h2><strong>Plotting tropical cyclone tracks</strong><a class="headerlink" href="#plotting-tropical-cyclone-tracks" title="Link to this heading">#</a></h2>
<p>We show tropical cyclones over the North Atlantic ocean and highlight those that made landfall in Texas, USA. The color  represents the maximum circular wind speed for the storm.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">ioff</span><span class="p">()</span>  <span class="c1"># Turns off interactive mode</span>

<span class="c1"># Define colormap</span>
<span class="n">cmap</span> <span class="o">=</span> <span class="n">cc</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">CET_R4</span>

<span class="c1"># Create figure and axes for subplots</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">subplot_kw</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="n">projection</span><span class="p">))</span>

<span class="c1"># Plot Model Tracks</span>
<span class="c1"># Plot all tracks in gray</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">tcr_plot</span><span class="o">.</span><span class="n">plot_tracks</span><span class="p">(</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">lat_mod</span><span class="p">,</span> <span class="n">lon_mod</span><span class="p">,</span> <span class="n">vmax_mod</span><span class="p">,</span> <span class="n">ind_mod</span><span class="p">,</span> <span class="n">interval</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">wind_speed_threshold</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> 
    <span class="n">extent</span><span class="o">=</span><span class="n">extent</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="n">projection</span><span class="p">,</span> <span class="n">shapefile</span><span class="o">=</span><span class="n">shpCONUS</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm</span>
<span class="p">)</span>

<span class="c1"># Plot tracks landfalling on TX in color</span>
<span class="n">im</span> <span class="o">=</span> <span class="n">tcr_plot</span><span class="o">.</span><span class="n">plot_tracks</span><span class="p">(</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">lat_mod</span><span class="p">,</span> <span class="n">lon_mod</span><span class="p">,</span> <span class="n">vmax_mod</span><span class="p">,</span> <span class="n">ind_TX_mod</span><span class="p">[:</span><span class="mi">50</span><span class="p">],</span> <span class="n">interval</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">wind_speed_threshold</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> 
    <span class="n">extent</span><span class="o">=</span><span class="n">extent</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="n">projection</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span> <span class="n">gridlabel</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">shapefile</span><span class="o">=</span><span class="n">shpCONUS</span><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="s1">&#39;E3SM-1-0&#39;</span><span class="p">,</span> <span class="n">title_ypos</span><span class="o">=</span><span class="mf">1.03</span><span class="p">,</span> <span class="n">wind_color</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">title_fontcolor</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm</span>
<span class="p">)</span>

<span class="c1"># Plot Reanalysis Tracks</span>
<span class="c1"># Plot all tracks in gray</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">tcr_plot</span><span class="o">.</span><span class="n">plot_tracks</span><span class="p">(</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">lat_rea</span><span class="p">,</span> <span class="n">lon_rea</span><span class="p">,</span> <span class="n">vmax_rea</span><span class="p">,</span> <span class="n">ind_rea</span><span class="p">,</span> <span class="n">interval</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">wind_speed_threshold</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
    <span class="n">extent</span><span class="o">=</span><span class="n">extent</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="n">projection</span><span class="p">,</span> <span class="n">shapefile</span><span class="o">=</span><span class="n">shpCONUS</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm</span>
<span class="p">)</span>

<span class="c1"># Plot tracks landfalling on TX in color</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">tcr_plot</span><span class="o">.</span><span class="n">plot_tracks</span><span class="p">(</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">lat_rea</span><span class="p">,</span> <span class="n">lon_rea</span><span class="p">,</span> <span class="n">vmax_rea</span><span class="p">,</span> <span class="n">ind_TX_rea</span><span class="p">[:</span><span class="mi">50</span><span class="p">],</span> <span class="n">interval</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">wind_speed_threshold</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> 
    <span class="n">extent</span><span class="o">=</span><span class="n">extent</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="n">projection</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span> <span class="n">gridlabel</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">shapefile</span><span class="o">=</span><span class="n">shpCONUS</span><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="s1">&#39;REANALYSIS&#39;</span><span class="p">,</span> <span class="n">title_ypos</span><span class="o">=</span><span class="mf">1.03</span><span class="p">,</span> <span class="n">wind_color</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">title_fontcolor</span><span class="o">=</span><span class="s1">&#39;tab:blue&#39;</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm</span>
<span class="p">)</span>

<span class="c1"># Plot Observations Tracks</span>
<span class="c1"># Plot all tracks in gray</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">tcr_plot</span><span class="o">.</span><span class="n">plot_tracks</span><span class="p">(</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">lat_obs</span><span class="p">,</span> <span class="n">lon_obs</span><span class="p">,</span> <span class="n">vmax_obs</span><span class="p">,</span> <span class="n">ind_obs</span><span class="p">,</span> <span class="n">interval</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">wind_speed_threshold</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> 
    <span class="n">extent</span><span class="o">=</span><span class="n">extent</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="n">projection</span><span class="p">,</span> <span class="n">shapefile</span><span class="o">=</span><span class="n">shpCONUS</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm</span>
<span class="p">)</span>

<span class="c1"># Plot tracks landfalling on TX in color</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">tcr_plot</span><span class="o">.</span><span class="n">plot_tracks</span><span class="p">(</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">lat_obs</span><span class="p">,</span> <span class="n">lon_obs</span><span class="p">,</span> <span class="n">vmax_obs</span><span class="p">,</span> <span class="n">ind_TX_obs</span><span class="p">[:</span><span class="mi">50</span><span class="p">],</span> <span class="n">interval</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">wind_speed_threshold</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> 
    <span class="n">extent</span><span class="o">=</span><span class="n">extent</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="n">projection</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span> <span class="n">gridlabel</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">shapefile</span><span class="o">=</span><span class="n">shpCONUS</span><span class="p">,</span> 
    <span class="n">title</span><span class="o">=</span><span class="s1">&#39;OBSERVATIONS&#39;</span><span class="p">,</span> <span class="n">title_ypos</span><span class="o">=</span><span class="mf">1.03</span><span class="p">,</span> <span class="n">wind_color</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">title_fontcolor</span><span class="o">=</span><span class="s1">&#39;tab:red&#39;</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># Add colorbar</span>
<span class="n">cbax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.22</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.024</span><span class="p">])</span>
<span class="n">cb</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">cax</span><span class="o">=</span><span class="n">cbax</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;horizontal&#39;</span><span class="p">)</span>
<span class="n">cb</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Maximum sustained wind speed (m/s)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=-</span><span class="mi">50</span><span class="p">)</span>
<span class="n">cb</span><span class="o">.</span><span class="n">set_ticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">9</span><span class="p">))</span>
<span class="n">cb</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Error in callback &lt;function _draw_all_if_interactive at 0x107806fc0&gt; (for post_execute), with arguments args (),kwargs {}:
</pre></div>
</div>
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">KeyboardInterrupt</span><span class="g g-Whitespace">                         </span>Traceback (most recent call last)
<span class="nn">File ~/miniconda3arm/envs/pyTCR1/lib/python3.13/site-packages/matplotlib/pyplot.py:279,</span> in <span class="ni">_draw_all_if_interactive</span><span class="nt">()</span>
<span class="g g-Whitespace">    </span><span class="mi">277</span> <span class="k">def</span><span class="w"> </span><span class="nf">_draw_all_if_interactive</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">278</span>     <span class="k">if</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">is_interactive</span><span class="p">():</span>
<span class="ne">--&gt; </span><span class="mi">279</span>         <span class="n">draw_all</span><span class="p">()</span>

<span class="nn">File ~/miniconda3arm/envs/pyTCR1/lib/python3.13/site-packages/matplotlib/_pylab_helpers.py:131,</span> in <span class="ni">Gcf.draw_all</span><span class="nt">(cls, force)</span>
<span class="g g-Whitespace">    </span><span class="mi">129</span> <span class="k">for</span> <span class="n">manager</span> <span class="ow">in</span> <span class="bp">cls</span><span class="o">.</span><span class="n">get_all_fig_managers</span><span class="p">():</span>
<span class="g g-Whitespace">    </span><span class="mi">130</span>     <span class="k">if</span> <span class="n">force</span> <span class="ow">or</span> <span class="n">manager</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">stale</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">131</span>         <span class="n">manager</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw_idle</span><span class="p">()</span>

<span class="nn">File ~/miniconda3arm/envs/pyTCR1/lib/python3.13/site-packages/matplotlib/backend_bases.py:1891,</span> in <span class="ni">FigureCanvasBase.draw_idle</span><span class="nt">(self, *args, **kwargs)</span>
<span class="g g-Whitespace">   </span><span class="mi">1889</span> <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_idle_drawing</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">1890</span>     <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_idle_draw_cntx</span><span class="p">():</span>
<span class="ne">-&gt; </span><span class="mi">1891</span>         <span class="bp">self</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<span class="nn">File ~/miniconda3arm/envs/pyTCR1/lib/python3.13/site-packages/matplotlib/backends/backend_agg.py:382,</span> in <span class="ni">FigureCanvasAgg.draw</span><span class="nt">(self)</span>
<span class="g g-Whitespace">    </span><span class="mi">379</span> <span class="c1"># Acquire a lock on the shared font cache.</span>
<span class="g g-Whitespace">    </span><span class="mi">380</span> <span class="k">with</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">toolbar</span><span class="o">.</span><span class="n">_wait_cursor_for_draw_cm</span><span class="p">()</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">toolbar</span>
<span class="g g-Whitespace">    </span><span class="mi">381</span>       <span class="k">else</span> <span class="n">nullcontext</span><span class="p">()):</span>
<span class="ne">--&gt; </span><span class="mi">382</span>     <span class="bp">self</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">renderer</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">383</span>     <span class="c1"># A GUI class may be need to update a window using this draw, so</span>
<span class="g g-Whitespace">    </span><span class="mi">384</span>     <span class="c1"># don&#39;t forget to call the superclass.</span>
<span class="g g-Whitespace">    </span><span class="mi">385</span>     <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>

<span class="nn">File ~/miniconda3arm/envs/pyTCR1/lib/python3.13/site-packages/matplotlib/artist.py:94,</span> in <span class="ni">_finalize_rasterization.&lt;locals&gt;.draw_wrapper</span><span class="nt">(artist, renderer, *args, **kwargs)</span>
<span class="g g-Whitespace">     </span><span class="mi">92</span> <span class="nd">@wraps</span><span class="p">(</span><span class="n">draw</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">93</span> <span class="k">def</span><span class="w"> </span><span class="nf">draw_wrapper</span><span class="p">(</span><span class="n">artist</span><span class="p">,</span> <span class="n">renderer</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="ne">---&gt; </span><span class="mi">94</span>     <span class="n">result</span> <span class="o">=</span> <span class="n">draw</span><span class="p">(</span><span class="n">artist</span><span class="p">,</span> <span class="n">renderer</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">95</span>     <span class="k">if</span> <span class="n">renderer</span><span class="o">.</span><span class="n">_rasterizing</span><span class="p">:</span>
<span class="g g-Whitespace">     </span><span class="mi">96</span>         <span class="n">renderer</span><span class="o">.</span><span class="n">stop_rasterizing</span><span class="p">()</span>

<span class="nn">File ~/miniconda3arm/envs/pyTCR1/lib/python3.13/site-packages/matplotlib/artist.py:71,</span> in <span class="ni">allow_rasterization.&lt;locals&gt;.draw_wrapper</span><span class="nt">(artist, renderer)</span>
<span class="g g-Whitespace">     </span><span class="mi">68</span>     <span class="k">if</span> <span class="n">artist</span><span class="o">.</span><span class="n">get_agg_filter</span><span class="p">()</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<span class="g g-Whitespace">     </span><span class="mi">69</span>         <span class="n">renderer</span><span class="o">.</span><span class="n">start_filter</span><span class="p">()</span>
<span class="ne">---&gt; </span><span class="mi">71</span>     <span class="k">return</span> <span class="n">draw</span><span class="p">(</span><span class="n">artist</span><span class="p">,</span> <span class="n">renderer</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">72</span> <span class="k">finally</span><span class="p">:</span>
<span class="g g-Whitespace">     </span><span class="mi">73</span>     <span class="k">if</span> <span class="n">artist</span><span class="o">.</span><span class="n">get_agg_filter</span><span class="p">()</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>

<span class="nn">File ~/miniconda3arm/envs/pyTCR1/lib/python3.13/site-packages/matplotlib/figure.py:3257,</span> in <span class="ni">Figure.draw</span><span class="nt">(self, renderer)</span>
<span class="g g-Whitespace">   </span><span class="mi">3254</span>             <span class="c1"># ValueError can occur when resizing a window.</span>
<span class="g g-Whitespace">   </span><span class="mi">3256</span>     <span class="bp">self</span><span class="o">.</span><span class="n">patch</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">renderer</span><span class="p">)</span>
<span class="ne">-&gt; </span><span class="mi">3257</span>     <span class="n">mimage</span><span class="o">.</span><span class="n">_draw_list_compositing_images</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">3258</span>         <span class="n">renderer</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="n">artists</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">suppressComposite</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">3260</span>     <span class="n">renderer</span><span class="o">.</span><span class="n">close_group</span><span class="p">(</span><span class="s1">&#39;figure&#39;</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">3261</span> <span class="k">finally</span><span class="p">:</span>

<span class="nn">File ~/miniconda3arm/envs/pyTCR1/lib/python3.13/site-packages/matplotlib/image.py:134,</span> in <span class="ni">_draw_list_compositing_images</span><span class="nt">(renderer, parent, artists, suppress_composite)</span>
<span class="g g-Whitespace">    </span><span class="mi">132</span> <span class="k">if</span> <span class="n">not_composite</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">has_images</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">133</span>     <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">artists</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">134</span>         <span class="n">a</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">renderer</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">135</span> <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">136</span>     <span class="c1"># Composite any adjacent images together</span>
<span class="g g-Whitespace">    </span><span class="mi">137</span>     <span class="n">image_group</span> <span class="o">=</span> <span class="p">[]</span>

<span class="nn">File ~/miniconda3arm/envs/pyTCR1/lib/python3.13/site-packages/matplotlib/artist.py:71,</span> in <span class="ni">allow_rasterization.&lt;locals&gt;.draw_wrapper</span><span class="nt">(artist, renderer)</span>
<span class="g g-Whitespace">     </span><span class="mi">68</span>     <span class="k">if</span> <span class="n">artist</span><span class="o">.</span><span class="n">get_agg_filter</span><span class="p">()</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<span class="g g-Whitespace">     </span><span class="mi">69</span>         <span class="n">renderer</span><span class="o">.</span><span class="n">start_filter</span><span class="p">()</span>
<span class="ne">---&gt; </span><span class="mi">71</span>     <span class="k">return</span> <span class="n">draw</span><span class="p">(</span><span class="n">artist</span><span class="p">,</span> <span class="n">renderer</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">72</span> <span class="k">finally</span><span class="p">:</span>
<span class="g g-Whitespace">     </span><span class="mi">73</span>     <span class="k">if</span> <span class="n">artist</span><span class="o">.</span><span class="n">get_agg_filter</span><span class="p">()</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>

<span class="nn">File ~/miniconda3arm/envs/pyTCR1/lib/python3.13/site-packages/cartopy/mpl/geoaxes.py:524,</span> in <span class="ni">GeoAxes.draw</span><span class="nt">(self, renderer, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">519</span>         <span class="bp">self</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="n">extent</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="n">origin</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">520</span>                     <span class="n">transform</span><span class="o">=</span><span class="n">factory</span><span class="o">.</span><span class="n">crs</span><span class="p">,</span> <span class="o">*</span><span class="n">factory_args</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span>
<span class="g g-Whitespace">    </span><span class="mi">521</span>                     <span class="o">**</span><span class="n">factory_kwargs</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">522</span> <span class="bp">self</span><span class="o">.</span><span class="n">_done_img_factory</span> <span class="o">=</span> <span class="kc">True</span>
<span class="ne">--&gt; </span><span class="mi">524</span> <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">renderer</span><span class="o">=</span><span class="n">renderer</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<span class="nn">File ~/miniconda3arm/envs/pyTCR1/lib/python3.13/site-packages/matplotlib/artist.py:71,</span> in <span class="ni">allow_rasterization.&lt;locals&gt;.draw_wrapper</span><span class="nt">(artist, renderer)</span>
<span class="g g-Whitespace">     </span><span class="mi">68</span>     <span class="k">if</span> <span class="n">artist</span><span class="o">.</span><span class="n">get_agg_filter</span><span class="p">()</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<span class="g g-Whitespace">     </span><span class="mi">69</span>         <span class="n">renderer</span><span class="o">.</span><span class="n">start_filter</span><span class="p">()</span>
<span class="ne">---&gt; </span><span class="mi">71</span>     <span class="k">return</span> <span class="n">draw</span><span class="p">(</span><span class="n">artist</span><span class="p">,</span> <span class="n">renderer</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">72</span> <span class="k">finally</span><span class="p">:</span>
<span class="g g-Whitespace">     </span><span class="mi">73</span>     <span class="k">if</span> <span class="n">artist</span><span class="o">.</span><span class="n">get_agg_filter</span><span class="p">()</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>

<span class="nn">File ~/miniconda3arm/envs/pyTCR1/lib/python3.13/site-packages/matplotlib/axes/_base.py:3210,</span> in <span class="ni">_AxesBase.draw</span><span class="nt">(self, renderer)</span>
<span class="g g-Whitespace">   </span><span class="mi">3207</span> <span class="k">if</span> <span class="n">artists_rasterized</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">3208</span>     <span class="n">_draw_rasterized</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_figure</span><span class="p">(</span><span class="n">root</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span> <span class="n">artists_rasterized</span><span class="p">,</span> <span class="n">renderer</span><span class="p">)</span>
<span class="ne">-&gt; </span><span class="mi">3210</span> <span class="n">mimage</span><span class="o">.</span><span class="n">_draw_list_compositing_images</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">3211</span>     <span class="n">renderer</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="n">artists</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_figure</span><span class="p">(</span><span class="n">root</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">suppressComposite</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">3213</span> <span class="n">renderer</span><span class="o">.</span><span class="n">close_group</span><span class="p">(</span><span class="s1">&#39;axes&#39;</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">3214</span> <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">False</span>

<span class="nn">File ~/miniconda3arm/envs/pyTCR1/lib/python3.13/site-packages/matplotlib/image.py:134,</span> in <span class="ni">_draw_list_compositing_images</span><span class="nt">(renderer, parent, artists, suppress_composite)</span>
<span class="g g-Whitespace">    </span><span class="mi">132</span> <span class="k">if</span> <span class="n">not_composite</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">has_images</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">133</span>     <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">artists</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">134</span>         <span class="n">a</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">renderer</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">135</span> <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">136</span>     <span class="c1"># Composite any adjacent images together</span>
<span class="g g-Whitespace">    </span><span class="mi">137</span>     <span class="n">image_group</span> <span class="o">=</span> <span class="p">[]</span>

<span class="nn">File ~/miniconda3arm/envs/pyTCR1/lib/python3.13/site-packages/matplotlib/artist.py:71,</span> in <span class="ni">allow_rasterization.&lt;locals&gt;.draw_wrapper</span><span class="nt">(artist, renderer)</span>
<span class="g g-Whitespace">     </span><span class="mi">68</span>     <span class="k">if</span> <span class="n">artist</span><span class="o">.</span><span class="n">get_agg_filter</span><span class="p">()</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<span class="g g-Whitespace">     </span><span class="mi">69</span>         <span class="n">renderer</span><span class="o">.</span><span class="n">start_filter</span><span class="p">()</span>
<span class="ne">---&gt; </span><span class="mi">71</span>     <span class="k">return</span> <span class="n">draw</span><span class="p">(</span><span class="n">artist</span><span class="p">,</span> <span class="n">renderer</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">72</span> <span class="k">finally</span><span class="p">:</span>
<span class="g g-Whitespace">     </span><span class="mi">73</span>     <span class="k">if</span> <span class="n">artist</span><span class="o">.</span><span class="n">get_agg_filter</span><span class="p">()</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>

<span class="nn">File ~/miniconda3arm/envs/pyTCR1/lib/python3.13/site-packages/cartopy/mpl/feature_artist.py:215,</span> in <span class="ni">FeatureArtist.draw</span><span class="nt">(self, renderer)</span>
<span class="g g-Whitespace">    </span><span class="mi">213</span> <span class="k">if</span> <span class="n">geom_path</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">214</span>     <span class="k">if</span> <span class="n">ax</span><span class="o">.</span><span class="n">projection</span> <span class="o">!=</span> <span class="n">feature_crs</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">215</span>         <span class="n">projected_geom</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">projection</span><span class="o">.</span><span class="n">project_geometry</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">216</span>             <span class="n">geom</span><span class="p">,</span> <span class="n">feature_crs</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">217</span>     <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">218</span>         <span class="n">projected_geom</span> <span class="o">=</span> <span class="n">geom</span>

<span class="nn">File ~/miniconda3arm/envs/pyTCR1/lib/python3.13/site-packages/cartopy/crs.py:827,</span> in <span class="ni">Projection.project_geometry</span><span class="nt">(self, geometry, src_crs)</span>
<span class="g g-Whitespace">    </span><span class="mi">825</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">method_name</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">826</span>     <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Unsupported geometry type </span><span class="si">{</span><span class="n">geom_type</span><span class="si">!r}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">827</span> <span class="k">return</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method_name</span><span class="p">)(</span><span class="n">geometry</span><span class="p">,</span> <span class="n">src_crs</span><span class="p">)</span>

<span class="nn">File ~/miniconda3arm/envs/pyTCR1/lib/python3.13/site-packages/cartopy/crs.py:960,</span> in <span class="ni">Projection._project_polygon</span><span class="nt">(self, polygon, src_crs)</span>
<span class="g g-Whitespace">    </span><span class="mi">958</span> <span class="n">multi_lines</span> <span class="o">=</span> <span class="p">[]</span>
<span class="g g-Whitespace">    </span><span class="mi">959</span> <span class="k">for</span> <span class="n">src_ring</span> <span class="ow">in</span> <span class="p">[</span><span class="n">polygon</span><span class="o">.</span><span class="n">exterior</span><span class="p">]</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="n">polygon</span><span class="o">.</span><span class="n">interiors</span><span class="p">):</span>
<span class="ne">--&gt; </span><span class="mi">960</span>     <span class="n">p_rings</span><span class="p">,</span> <span class="n">p_mline</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_project_linear_ring</span><span class="p">(</span><span class="n">src_ring</span><span class="p">,</span> <span class="n">src_crs</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">961</span>     <span class="k">if</span> <span class="n">p_rings</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">962</span>         <span class="n">rings</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">p_rings</span><span class="p">)</span>

<span class="nn">File ~/miniconda3arm/envs/pyTCR1/lib/python3.13/site-packages/cartopy/crs.py:846,</span> in <span class="ni">Projection._project_linear_ring</span><span class="nt">(self, linear_ring, src_crs)</span>
<span class="g g-Whitespace">    </span><span class="mi">841</span> <span class="n">debug</span> <span class="o">=</span> <span class="kc">False</span>
<span class="g g-Whitespace">    </span><span class="mi">842</span> <span class="c1"># 1) Resolve the initial lines into projected segments</span>
<span class="g g-Whitespace">    </span><span class="mi">843</span> <span class="c1"># 1abc</span>
<span class="g g-Whitespace">    </span><span class="mi">844</span> <span class="c1"># def23ghi</span>
<span class="g g-Whitespace">    </span><span class="mi">845</span> <span class="c1"># jkl41</span>
<span class="ne">--&gt; </span><span class="mi">846</span> <span class="n">multi_line_string</span> <span class="o">=</span> <span class="n">cartopy</span><span class="o">.</span><span class="n">trace</span><span class="o">.</span><span class="n">project_linear</span><span class="p">(</span><span class="n">linear_ring</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">847</span>                                                  <span class="n">src_crs</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">849</span> <span class="c1"># Threshold for whether a point is close enough to be the same</span>
<span class="g g-Whitespace">    </span><span class="mi">850</span> <span class="c1"># point as another.</span>
<span class="g g-Whitespace">    </span><span class="mi">851</span> <span class="n">threshold</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x_limits</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_limits</span><span class="p">))</span> <span class="o">*</span> <span class="mf">1e-5</span>

<span class="nn">File lib/cartopy/trace.pyx:598,</span> in <span class="ni">cartopy.trace.project_linear</span><span class="nt">()</span>

<span class="nn">File lib/cartopy/trace.pyx:99,</span> in <span class="ni">cartopy.trace.LineAccumulator.as_geom</span><span class="nt">()</span>

<span class="nn">File ~/miniconda3arm/envs/pyTCR1/lib/python3.13/site-packages/shapely/geometry/linestring.py:66,</span> in <span class="ni">LineString.__new__</span><span class="nt">(self, coordinates)</span>
<span class="g g-Whitespace">     </span><span class="mi">63</span>             <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">     </span><span class="mi">64</span>                 <span class="k">return</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">o</span><span class="p">]</span>
<span class="ne">---&gt; </span><span class="mi">66</span>         <span class="n">coordinates</span> <span class="o">=</span> <span class="p">[</span><span class="n">_coords</span><span class="p">(</span><span class="n">o</span><span class="p">)</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">coordinates</span><span class="p">]</span>
<span class="g g-Whitespace">     </span><span class="mi">68</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">coordinates</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<span class="g g-Whitespace">     </span><span class="mi">69</span>     <span class="c1"># empty geometry</span>
<span class="g g-Whitespace">     </span><span class="mi">70</span>     <span class="c1"># TODO better constructor + should shapely.linestrings handle this?</span>
<span class="g g-Whitespace">     </span><span class="mi">71</span>     <span class="k">return</span> <span class="n">shapely</span><span class="o">.</span><span class="n">from_wkt</span><span class="p">(</span><span class="s2">&quot;LINESTRING EMPTY&quot;</span><span class="p">)</span>

<span class="nn">File ~/miniconda3arm/envs/pyTCR1/lib/python3.13/site-packages/shapely/geometry/linestring.py:64,</span> in <span class="ni">LineString.__new__.&lt;locals&gt;._coords</span><span class="nt">(o)</span>
<span class="g g-Whitespace">     </span><span class="mi">62</span>     <span class="k">return</span> <span class="n">o</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="g g-Whitespace">     </span><span class="mi">63</span> <span class="k">else</span><span class="p">:</span>
<span class="ne">---&gt; </span><span class="mi">64</span>     <span class="k">return</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">o</span><span class="p">]</span>

<span class="ne">KeyboardInterrupt</span>: 
</pre></div>
</div>
</div>
</div>
</section>
<section id="plot-tropical-cyclone-power-dissipitation-index">
<h2><strong>Plot tropical cyclone Power Dissipitation Index</strong><a class="headerlink" href="#plot-tropical-cyclone-power-dissipitation-index" title="Link to this heading">#</a></h2>
<p>The PDI is based on storm frequency, wind speed, and duration. It places more emphasis on storm intensity by using the cube of the wind speed rather than the wind speed squared as in the ACE index. A complete description of how the PDI is calculated can be found <a class="reference external" href="https://www.nature.com/articles/nature03906">here</a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define levels and colormap</span>
<span class="n">levels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">13</span><span class="p">)</span>
<span class="n">cmap</span> <span class="o">=</span> <span class="n">cc</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">rainbow</span>

<span class="c1"># Create figure and axes</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">subplot_kw</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="n">projection</span><span class="p">))</span>

<span class="c1"># Plot MODEL density</span>
<span class="n">im</span> <span class="o">=</span> <span class="n">tcr_plot</span><span class="o">.</span><span class="n">plot_density</span><span class="p">(</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">lat_mod_cs</span><span class="p">,</span> <span class="n">lon_mod_cs</span><span class="p">,</span> <span class="n">pdi_mod</span> <span class="o">/</span> <span class="n">num_years</span><span class="p">,</span> <span class="n">levels</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="n">extent</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="n">projection</span><span class="p">,</span> 
    <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span> <span class="n">logscale</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">gridlabel</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">shapefile</span><span class="o">=</span><span class="n">shpCONUS</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;E3SM-1-0&#39;</span><span class="p">,</span> 
    <span class="n">title_ypos</span><span class="o">=</span><span class="mf">1.03</span><span class="p">,</span> <span class="n">title_fontcolor</span><span class="o">=</span><span class="s1">&#39;k&#39;</span>
<span class="p">)</span>

<span class="c1"># Plot REANALYSIS density</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">tcr_plot</span><span class="o">.</span><span class="n">plot_density</span><span class="p">(</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">lat_rea_cs</span><span class="p">,</span> <span class="n">lon_rea_cs</span><span class="p">,</span> <span class="n">pdi_rea</span> <span class="o">/</span> <span class="n">num_years</span><span class="p">,</span> <span class="n">levels</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="n">extent</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="n">projection</span><span class="p">,</span>
    <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span> <span class="n">logscale</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">gridlabel</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">shapefile</span><span class="o">=</span><span class="n">shpCONUS</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;REANALYSIS&#39;</span><span class="p">,</span> 
    <span class="n">title_ypos</span><span class="o">=</span><span class="mf">1.03</span><span class="p">,</span> <span class="n">title_fontcolor</span><span class="o">=</span><span class="s1">&#39;tab:blue&#39;</span>
<span class="p">)</span>

<span class="c1"># Plot OBSERVATIONS density</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">tcr_plot</span><span class="o">.</span><span class="n">plot_density</span><span class="p">(</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">lat_obs_cs</span><span class="p">,</span> <span class="n">lon_obs_cs</span><span class="p">,</span> <span class="n">pdi_obs</span> <span class="o">/</span> <span class="n">num_years</span><span class="p">,</span> <span class="n">levels</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="n">extent</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="n">projection</span><span class="p">,</span>
    <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span> <span class="n">logscale</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">gridlabel</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">shapefile</span><span class="o">=</span><span class="n">shpCONUS</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;OBSERVATIONS&#39;</span><span class="p">,</span>
    <span class="n">title_ypos</span><span class="o">=</span><span class="mf">1.03</span><span class="p">,</span> <span class="n">title_fontcolor</span><span class="o">=</span><span class="s1">&#39;tab:red&#39;</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># Add colorbar</span>
<span class="n">cbax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.22</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.025</span><span class="p">])</span>
<span class="n">cb</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">cax</span><span class="o">=</span><span class="n">cbax</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;horizontal&#39;</span><span class="p">)</span>
<span class="n">cb</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Power Dissipation Index ($m^3 s^{-2}$)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=-</span><span class="mi">52</span><span class="p">)</span>
<span class="n">cb</span><span class="o">.</span><span class="n">set_ticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">cb</span><span class="o">.</span><span class="n">set_ticklabels</span><span class="p">([</span><span class="sa">r</span><span class="s1">&#39;$10^</span><span class="si">{6}</span><span class="s1">$&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$10^</span><span class="si">{7}</span><span class="s1">$&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$10^</span><span class="si">{8}</span><span class="s1">$&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$10^</span><span class="si">{9}</span><span class="s1">$&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$10^</span><span class="si">{10}</span><span class="s1">$&#39;</span><span class="p">])</span>
<span class="n">cb</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/6ce3ee261940533314703ade5ff73623eedf8e568b9a14b24e354213d81e11ff.png" src="../_images/6ce3ee261940533314703ade5ff73623eedf8e568b9a14b24e354213d81e11ff.png" />
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./examples"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="ex0_download_tracks_from_cmip6.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><strong>0. Download tropical cyclone tracks</strong></p>
      </div>
    </a>
    <a class="right-next"
       href="ex2_rainfall_generation.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><strong>2. Tropical cyclone rainfall generation</strong></p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#description"><strong>Description</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#import-libraries"><strong>Import libraries</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-configurations"><strong>Plot configurations</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#tropical-cyclone-observations"><strong>Tropical cyclone observations</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#tropical-cyclone-downscaled-from-reanalysis-era5"><strong>Tropical cyclone downscaled from Reanalysis-ERA5</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#tropical-cyclone-data-downscaled-from-cmip6-models"><strong>Tropical cyclone data downscaled from CMIP6 models</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#set-up-plot-and-identify-tracks-landfalling-texas"><strong>Set up plot and identify tracks landfalling Texas</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plotting-tropical-cyclone-tracks"><strong>Plotting tropical cyclone tracks</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-tropical-cyclone-power-dissipitation-index"><strong>Plot tropical cyclone Power Dissipitation Index</strong></a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Phong V.V. Le
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      Â© Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>